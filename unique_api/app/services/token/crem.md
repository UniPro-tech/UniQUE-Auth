## 1. アクセストークン（Access Token）

| 種別          | クレーム名                     | 説明                                                     |
| ----------- | ------------------------- | ------------------------------------------------------ |
| **基本情報**    | `iss`                     | 発行者（Issuer URI）例: `https://auth.example.com`           |
|             | `sub`                     | ユーザーを一意に識別するSubject ID（ユーザーID）                         |
|             | `aud`                     | 対象のリソースサーバー（API識別子）                                    |
|             | `exp`                     | 有効期限（Unix time）短期（5〜15分推奨）                             |
|             | `iat`                     | 発行日時                                                   |
|             | `jti`                     | JWTの一意識別子（リプレイ攻撃防止）                                    |
| **権限・スコープ** | `scope`                   | 許可されたスコープ（例: `"openid profile email"`, `"read:users"`） |
|             | `client_id`               | トークンを発行したクライアントID                                      |
|             | `roles` または `permissions` | 役割やAPIアクセス権限（カスタムクレーム）                                 |
| **OIDC拡張**  | `auth_time`               | 認証が行われた時間（再認証要求のため）                                    |
|             | `amr`                     | 認証手段（例: `"pwd"`, `"mfa"`）                              |
| **追加的メタ情報** | `azp`                     | Authorized party（＝クライアントID、`aud`と異なる場合）                |
|             | `tenant` / `org`          | マルチテナント環境なら所属情報を付与                                     |
| **カスタム拡張**  | `session_id`              | セッションと関連付けたい場合                                         |
|             | `ip` / `ua`               | クライアントIPやUserAgent（セキュリティ強化用、任意）                       |


## 2. リフレッシュトークン（Refresh Token）

| 種別           | クレーム名                      | 説明                                 |
| ------------ | -------------------------- | ---------------------------------- |
| **基本情報**     | `iss`                      | 発行者（Issuer URI）                    |
|              | `sub`                      | ユーザー識別子（アクセストークンと一致させる）            |
|              | `aud`                      | トークンエンドポイントまたはクライアントID             |
|              | `exp`                      | 有効期限（長期：数日〜数週間）                    |
|              | `iat`                      | 発行日時                               |
|              | `jti`                      | JWT ID（DB側で失効管理に使う）                |
| **制御用メタ情報**  | `client_id`                | 発行元クライアントID（再発行時に一致確認）             |
|              | `scope`                    | 再発行可能なスコープ（スコープダウン可）               |
|              | `rotated` / `previous_jti` | ローテーション対応（Refresh Token Rotation用） |
|              | `session_id`               | セッション識別子（セッション失効時に無効化）             |
|              | `ip` / `ua`                | 発行時のクライアント情報（不正利用検知用）              |
| **OIDC拡張**   | `auth_time`                | 認証時刻（長期利用トラッキング）                   |
|              | `amr`                      | 認証手段（例: `"pwd"`, `"mfa"`）          |
| **カスタム（任意）** | `tenant` / `org`           | 組織単位の制御                            |
|              | `refresh_counter`          | 更新回数の制限制御（ローテーション検知）               |
